import{m as l}from"./vuex.cc7cb26e.js";import{a as m}from"./axios.6ec123f8.js";import{n as r,e as p}from"./app.bc3ad3e2.js";import"./@micro-zoe.c2e1472d.js";import"./jquery.e403903e.js";import"./@babel.f9bcab46.js";import"./dayjs.b89f6725.js";import"./localforage.71b7b823.js";import"./markdown-it.bda97caf.js";import"./mdurl.ce6c1dd8.js";import"./uc.micro.8d343c98.js";import"./entities.48a44fec.js";import"./linkify-it.c5e8196e.js";import"./punycode.js.4b3f125a.js";import"./highlight.js.cb28ef06.js";import"./markdown-it-link-attributes.e1d5d151.js";import"./@traptitech.79d08561.js";import"./vue.fd9b772e.js";import"./openpgp_hi.15f91b1d.js";import"./mitt.1ea0a2a3.js";import"./vue-router.2d566cd7.js";import"./vue-clipboard2.50be9c5e.js";import"./clipboard.058ef547.js";import"./view-design-hi.92ef2000.js";import"./vuedraggable.9fd6afed.js";import"./sortablejs.d74243d9.js";import"./vue-resize-observer.c3c9ca4e.js";import"./element-sea.7f208f9b.js";import"./deepmerge.cecf392e.js";import"./resize-observer-polyfill.0bdc1850.js";import"./throttle-debounce.7c3948b2.js";import"./babel-helper-vue-jsx-merge-props.5ed215c3.js";import"./normalize-wheel.2a034b9f.js";import"./async-validator.49abba38.js";import"./babel-runtime.4773988a.js";import"./core-js.314b4a1d.js";import"./lodash.18c5398d.js";var c=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"mobile-nav-box"},[t._t("left",function(){return[e("div",{staticClass:"nav-back",on:{click:t.onBack}},[e("i",{staticClass:"taskfont"},[t._v("\uE676")])])]}),e("div",{staticClass:"nav-title"},[t._v(t._s(t.title))]),t._t("right")],2)},h=[];const u={name:"MobileNavTitle",props:{title:{default:""},beforeBack:{type:Function}},methods:{onBack(){if(typeof this.beforeBack=="function"){const t=this.beforeBack();t&&t.then&&t.then(()=>{this.goBack()});return}this.goBack()}}},n={};var d=r(u,c,h,!1,v,"305e6ddf",null,null);function v(t){for(let i in n)this[i]=n[i]}var _=function(){return d.exports}(),g=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"page-setting"},[e("PageTitle",{attrs:{title:t.titleNameRoute}}),e("div",{staticClass:"setting-head"},[e("div",{staticClass:"setting-titbox"},[e("div",{staticClass:"setting-title"},[e("h1",[t._v(t._s(t.settingTitleName))])])])]),e("div",{staticClass:"setting-box"},[e("div",{staticClass:"setting-menu"},[e("MobileNavTitle",{attrs:{title:t.$L("\u8BBE\u7F6E")}}),e("ul",t._l(t.menu,function(s,o){return e("li",{key:o,class:t.classNameRoute(s.path,s.divided),on:{click:function(b){return t.toggleRoute(s.path)}}},[s.path==="version"?[e("AutoTip",{attrs:{disabled:""}},[t._v(t._s(t.$L(s.name)))]),t.clientNewVersion?e("Badge",{attrs:{text:t.clientNewVersion}}):t._e()]:s.path==="version-show"?[e("AutoTip",[t._v(t._s(t.$L(s.name))+": "+t._s(t.version))])]:e("span",[t._v(t._s(t.$L(s.name)))])],2)}),0)],1),e("transition",{attrs:{name:t.$isEEUiApp?"mobile-dialog":"none"}},[t.showContent?e("div",{staticClass:"setting-content"},[e("MobileNavTitle",{attrs:{title:t.settingTitleName}}),e("div",{staticClass:"setting-content-title"},[t._v(t._s(t.titleNameRoute))]),e("div",{staticClass:"setting-content-view"},[e("router-view",{staticClass:"setting-router-view"})],1)],1):t._e()])],1)],1)},$=[];const f={components:{MobileNavTitle:_},data(){return{version:window.systemInfo.version}},mounted(){this.$isEEUiApp&&(this.version=`${window.systemInfo.version} (${$A.eeuiAppLocalVersion()})`)},computed:{...l(["userInfo","userIsAdmin","clientNewVersion","systemConfig"]),routeName(){return this.$route.name},showContent(){return this.$route.path.match(/^\/manage\/setting\/\w+$/)},menu(){const t=[{path:"personal",name:"\u4E2A\u4EBA\u8BBE\u7F6E"},{path:"password",name:"\u5BC6\u7801\u8BBE\u7F6E"},{path:"email",name:"\u4FEE\u6539\u90AE\u7BB1"},{path:"language",name:"\u8BED\u8A00\u8BBE\u7F6E",divided:!0},{path:"theme",name:"\u4E3B\u9898\u8BBE\u7F6E"}];return(this.$Electron||this.$isEEUiApp)&&t.push({path:"keyboard",name:"\u952E\u76D8\u8BBE\u7F6E",desc:" (Beta)"}),$A.isDooServer()&&this.$isEEUiApp&&t.push({path:"privacy",name:"\u9690\u79C1\u653F\u7B56",divided:!0},{path:"delete",name:"\u5220\u9664\u5E10\u53F7"}),this.userIsAdmin&&t.push({path:"system",name:"\u7CFB\u7EDF\u8BBE\u7F6E",divided:!0},{path:"license",name:"License Key"}),t.push({path:"version",name:"\u66F4\u65B0\u65E5\u5FD7",divided:!0},{path:"version-show",name:"\u7248\u672C"},{path:"clearCache",name:"\u6E05\u9664\u7F13\u5B58",divided:!0},{path:"logout",name:"\u9000\u51FA\u767B\u5F55"}),t},titleNameRoute(){const{routeName:t,menu:i}=this;let e="";return i.some(s=>{if(t===`manage-setting-${s.path}`)return e=`${this.$L(s.name)}${s.desc||""}`,!0}),e||this.$L("\u8BBE\u7F6E")},settingTitleName(){return this.windowPortrait?this.titleNameRoute:this.$L("\u8BBE\u7F6E")}},watch:{routeName:{handler(t){t==="manage-setting"&&this.windowLandscape&&this.goForward({name:"manage-setting-personal"},!0)},immediate:!0}},methods:{toggleRoute(t){switch(t){case"clearCache":$A.modalConfirm({title:"\u6E05\u9664\u7F13\u5B58",content:"\u4F60\u786E\u5B9A\u8981\u6E05\u9664\u7F13\u5B58\u5417\uFF1F",onOk:()=>{$A.IDBSet("clearCache","handle").then(i=>{$A.reloadUrl()})}});break;case"logout":$A.modalConfirm({title:"\u9000\u51FA\u767B\u5F55",content:"\u4F60\u786E\u5B9A\u8981\u767B\u51FA\u7CFB\u7EDF\u5417\uFF1F",onOk:()=>{this.$store.dispatch("logout",!1)}});break;case"version-show":this.onVersion();break;case"privacy":this.openPrivacy();break;case"index":this.goForward({name:"manage-setting"});break;default:if(t==="version"&&!!this.clientNewVersion){p.emit("updateNotification",null);return}this.goForward({name:"manage-setting-"+t});break}},openPrivacy(){const t=$A.apiUrl("privacy");this.$isEEUiApp?this.$store.dispatch("openAppChildPage",{pageType:"app",pageTitle:" ",url:"web.js",params:{url:t,browser:!0,showProgress:!0}}):window.open(t)},classNameRoute(t,i){return{flex:!0,active:this.windowLandscape&&this.routeName===`manage-setting-${t}`,divided:!!i}},async onVersion(){const t=[`${this.$L("\u670D\u52A1\u5668")}: ${$A.getDomain($A.mainUrl())}`];await this.$store.dispatch("showSpinner",600);try{const i=await this.getServerVersion();t.push(`${this.$L("\u670D\u52A1\u5668\u7248\u672C")}: v${i}`)}catch{t.push(`${this.$L("\u670D\u52A1\u5668\u7248\u672C")}: `+this.$L("\u83B7\u53D6\u5931\u8D25"))}await this.$store.dispatch("hiddenSpinner"),t.push(`${this.$L("\u5BA2\u6237\u7AEF\u7248\u672C")}: v${this.version}`),$A.modalInfo({language:!1,title:this.$L("\u7248\u672C\u4FE1\u606F"),content:t.join("<br/>")})},getServerVersion(){return new Promise((t,i)=>{if(/^\d+\.\d+\.\d+$/.test(this.systemConfig.server_version)){t(this.systemConfig.server_version);return}m.get($A.apiUrl("system/version")).then(({status:e,data:s})=>{e===200&&t(s.version)}).catch(i)})}}},a={};var w=r(f,g,$,!1,C,null,null,null);function C(t){for(let i in a)this[i]=a[i]}var rt=function(){return w.exports}();export{rt as default};
